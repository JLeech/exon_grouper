Алгоритм:


 
                Рассматриваем
экзон (exon).  Есть множество организмов(organisms)
которым этот экзон не принадлежит. Выберем любой элемент этого множества(organism).  Для этого
организма берём все его экзоны, которые пересекаются с exon хотя бы по
одной координате (аминокислотному остатку), обозначим это множество EI(exon, organism) “Exon Intersections”.  Для каждого организма из organisms составляем своё множество. Конкатенируем экзоны из множества
EI(exon, organism) и
получаем один элемент CEI(exon, organism) “Concatenated
Exon Intersections”. CEIS(exon, organisms) =   ( CEI(exon, organism)  organism  organisms).


Очевидно, что для каждого
организма будет свой элемент в CEI. Organism
<-> CEI(exon, organism) – биекция.


Пока
рассматриваем один экзон(exon) и его множество CEIS для всех организмов. Для каждого
элемента CEI строим
его локальное выравнивание с exon. Имеем координаты(границы)
локального выравнивания внутри exon. Эти координаты
являются элементом LB(exon, organism) “LocalBounds” множества LBS (exon, organisms). Более детально, элементом множества LBS является пара координат [start, end], позиция начала локального выравнивания относительно начала
exon, аналогично для end.  Одному элементу множества CEIS(exon,organisms)  соответствует один элемент из LBS(exon, organisms).



Я считаю, что в силу  консервативности экзонов при рассмотрении
большого числа организмов, элементы множества LBS(exon, organisms) будут хорошо
кластеризоваться. Кластер назовём сильным, если у него “много“ элементов.  Два элемента(пара координат) в множестве LSB являются
похожими если у них “похожи” координаты начал и концов. Это позволяет не просто
найти “хорошее” выравнивание, то, что вы
предлагаете, но и найти места в экзоне которые хорошо выравниваются и плохо
выравниваются. Это достигается, так как имеется не только отображение длинного
экзона на конкатенацию коротких, но и отображение короткого на длинный. Т.е.
длинный экзон размечается на куски, на которые выравниваются меньшие экзоны из
других организмов.


Более формально:


Рассмотрим exon.  Для него имеется LBS(exon, organisms).
Если exon – длинный, то
его EI(exon, organism) : { exon_i,…,exon_j
}, i<j, i,j
 N,
элементы этого множества принадлежат organism.
Одновременно с этим,определено  LBS(exon_k,organism_exon) , где i <= k <= j , а organism_exon
– организм который содержит exon. Так как считается(грубо), что LBS(exon_k,organism_exon) = {LB(exon_k, exon )}, т.е. LBS
для exon_k
содержит всего 1 пару координат: координаты локального
выравнивания exon_k
и exon.
Это позволяет найти “хорошие” участки внутри exon, в которые отображается много экзонов из
других организмов. Т.е. можно разметить exon на
консервативные и неконсервативные участки. В
этом и состоит преимущество моего метода с границами.
